<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cms.dao.YlLaAgentDao">

    <select id="DismissQueryList" parameterType="com.cms.pojo.DismissQueryPojo"
            resultType="com.cms.pojo.DismissQueryReturnPojo">
      select t1.agent_code,
       t1.agent_name,
       t2.manage_com as comCode4,
       t2.branch_attr as branchAttr,
       (SELECT yl_name FROM ld_com_new WHERE ld_com_new.com_code=t1.manage_com) AS manageCom4,
       t1.agent_group,
       t2.branch_name,
       t1.agent_grade as agentGradeCom,
       (SELECT grade_name FROM la_agent_grade WHERE la_agent_grade.grade_code=t1.agent_grade) AS agentGradeName,
       t3.depart_date as diffDate,
       t3.depart_reason as diffCauseCom,
       (select ld_code.code_name from ld_code where ld_code.code_type='departreason' and t3.depart_reason=ld_code.code) as diffCauseName,
       t3.noti as illustrate,
       t3.depart_state as agentStateCom,
       (select ld_code.code_name from ld_code where ld_code.code_type='agydepartstate' and t3.depart_state=ld_code.code)as agentStateName
       from yl_la_agent as t1
         JOIN yl_la_branch_group AS t2
              ON t1.agent_group = t2.agent_group
         JOIN yl_la_dimission AS t3
              ON t1.agent_code = t3.agent_code
               ${ew.customSqlSegment}
    </select>
</mapper>