<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cms.dao.SearchListDao">

    <select id="SearchList" parameterType="com.cms.pojo.SearchListPojo"
            resultType="com.cms.pojo.ResultListPojo">
        select t1.agent_code,
               t1.agent_name,
               t1.employ_date,
               t1.agent_state,
               t1.agent_grade,
               t1.agent_group,
               t3.contract_type,
               t4.branch_name,
               t4.manage_com as com_code4 ,
               (SELECT yl_name FROM ld_com_new WHERE ld_com_new.com_code=com_code4) AS manageCom4,
               (SELECT up_com_code FROM ld_com_new WHERE t4.manage_com=ld_com_new.com_code) AS com_code3,
               (SELECT yl_name FROM ld_com_new WHERE ld_com_new.com_code=com_code3) AS manageCom3,
               (SELECT up_com_code FROM ld_com_new WHERE ld_com_new.com_code=com_code3) AS com_code2,
               (SELECT yl_name FROM ld_com_new WHERE ld_com_new.com_code=com_code2) AS manageCom2,
            (SELECT code_name FROM ld_code WHERE ld_code.code_type='agentstate' AND code=t1.agent_state) AS agentState,
            (SELECT code_name FROM ld_code WHERE ld_code.code_type='contracttype' AND code=t3.contract_type) AS contractType,
            (SELECT grade_name FROM la_agent_grade WHERE la_agent_grade.grade_code=t1.agent_grade) AS agentGrade
        from yl_la_agent AS t1
                 JOIN yl_la_agent_attr AS t3
                      ON t1.agent_code = t3.agent_code
                 JOIN yl_la_branch_group AS t4
                      ON t1.agent_group = t4.agent_group
            ${ew.customSqlSegment}
    </select>


</mapper>