<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cms.dao.YlSelectExcellDao">

    <select id="YlSelectExcell" parameterType="com.cms.pojo.YlMSelectExcellPojo"
            resultType="com.cms.pojo.YlMSelectExcellPojo">
        SELECT     t5.com_code as manageCom4,
                   t5.yl_name  as manageName4,
                   (select la_agent_grade.grade_name from la_agent_grade where la_agent_grade.grade_code=t1.agent_grade)  agentGrade,
                   t1.sap_code as sapCode,
                   t1.agent_name as agentName,
                   (select ld_code.code_name from ld_code where ld_code.code_type='agentstate' and t1.agent_state=ld_code.code) agentState,
                   (select ld_code.code_name from ld_code where ld_code.code_type='ylpost' and t1.agent_job=ld_code.code) agentJob,
                   t1.agent_grade as agentGrade,
                   (select y.code_name from ld_code y where y.code_type='sex' and t2.sex=y.code) sex,
                   t2.birthday as birthday,
                   (select y.code_name from ld_code y where y.code_type='idtype' and t2.id_type=y.code) as idType,
                   t2.id_no as idNo,
                   t1.employ_date as employDate,
                   t1.out_work_date as outDate,
                   (select ld_code.code_name from ld_code where ld_code.code_type='rgttype' and t2.rgt_type=ld_code.code)as rgtType,
                   (select yl_la_area.place_name from yl_la_area where yl_la_area.place_type='01' and t2.reg_address=yl_la_area.place_code)as rgtProvince,
                   (select ld_code.code_name from ld_code where ld_code.code_type='highestdegree' and t2.highest_degree=ld_code.code) as highestDegree,
                   (select ld_code.code_name from ld_code where ld_code.code_type='highestdegree' and t2.first_degree=ld_code.code) as firstDegree,
                   (select ld_code.code_name from ld_code where ld_code.code_type='degree' and t2.degree=ld_code.code) as degree,
                   t2.graduate_school as graduateSchool,
                   t2.major as major,
                   (select ld_code.code_name from ld_code where ld_code.code_type='nationality' and t2.nationality=ld_code.code)as nationality,
                   (select ld_code.code_name from ld_code where ld_code.code_type='nativeplace' and t2.nativeplace=ld_code.code) as nativeplace,
                   (select ld_code.code_name from ld_code where ld_code.code_type='industrytype' and t2.old_industry_type=ld_code.code) as oldIndustryType,
                   t2.old_occupation as oldOccupation,
                   t2.old_com as oldCom,
                   t2.old_job_duty as oldJobDuty,
                   t2.work_age as workAge,
                   t2.address as homeAddress,
                   t2.postcode as postcode,
                   t2.homephone as homephone,
                   t2.phone as phone,
                   t2.email as email,
                   (select ld_code.code_name from ld_code where ld_code.code_type='polityvisage' and t2.outlook_status=ld_code.code) as outlookStatus,
                   (select ld_code.code_name from ld_code where ld_code.code_type='bankcode' and t2.bank_code=ld_code.code) as bankCode,
                   t2.bank_account as bankAccount,
                   t2.unite_bank_num as uniteBankNum,
                   (select yl_la_area.place_name from yl_la_area where yl_la_area.place_type='01' and t2.bank_province=yl_la_area.place_code) as bankProvince ,
                   (select yl_la_area.place_name from yl_la_area where yl_la_area.place_type='02' and t2.bank_city=yl_la_area.place_code)as bankCity,
                   t2.contract_type as contractType,
                   t2.contract_start_date as contractStartDate,
                   t2.contract_end_date as contractEndDate,
                   t3.branch_attr as branchAttr,
                   t3.branch_name as branchName,
                   t3.branch_manager as branchManagerCode,
                   t3.branch_manager_name as branchManagerName,
                   t3.branch_manager_phone as branchManagerPhone
        FROM yl_la_agent AS t1
                 JOIN yl_la_agent_attr AS t2 ON t1.agent_code=t2.agent_code
                 JOIN yl_la_branch_group AS t3 ON t1.agent_group=t3.agent_group
                 JOIN la_agent_grade AS t4 ON t1.agent_grade=t4.grade_code
                 JOIN ld_com_new AS t5 ON t1.manage_com=t5.com_code
            ${ew.customSqlSegment}
    </select>
</mapper>